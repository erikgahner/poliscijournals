---
title: ""
output: md_document
always_allow_html: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

```

# Show script


```{r generateTable, echo=FALSE, message=FALSE, warning=FALSE}
library("tidyverse")
library("kableExtra")
library("scholar")
library("readxl")

raw_data <- read_xlsx("raw_data.xlsx")

journal_list <- raw_data$Journal

journal_if <- get_impactfactor(journal_list, max.distance = 0.05)

journal_full <- left_join(raw_data, journal_if, by = "Journal")

journal_full <- journal_full %>%
  mutate(Journal = str_to_title(Journal))

journal_full %>%
  arrange(-ImpactFactor) %>%
  mutate_at(.vars = vars(article, letter),
        .funs = funs(. = case_when(
          . == 1 ~ "Yes",
          . == 0 ~ "No"
        ))) %>%
  select(Journal = Journal, Article = article_., `Article: Word limit` = article_wordlimit, Letter = letter, `Letter: Word limit` = letter_limit, `Impact factor` = ImpactFactor, Eigenfactor) %>%
  kable(., format = "markdown") %>%
  kable_styling()
```

FIN